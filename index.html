<!DOCTYPE html>
<html lang="es" data-bs-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Interface - Bootstrap Dark Mode</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        body {
            height: 100vh;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            transition: transform 0.3s ease;
        }

        .chat-container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        textarea {
            border: none !important;
            resize: none;
            box-shadow: none !important;
        }

        /* Ocualtar el Scroll */
        .overflow-y-auto.no-scroll::-webkit-scrollbar {
            display: none
        }



        /* Animaci칩n de pulso al hacer clic */
        .btn-action-gemini i {
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: inline-block;
        }

        .btn-action-gemini:active i {
            transform: scale(1.4);
        }

        /* Evitar el borde azul de enfoque de Bootstrap */
        .btn-action-gemini:focus {
            box-shadow: none !important;
        }

        /* Forzar que el bot칩n de copiar no sea azul al hacer clic */
        .btn-copy:active,
        .btn-copy:focus {
            color: var(--bs-body-color) !important;
            /* Negro en modo claro, Blanco en modo oscuro */
            background-color: transparent !important;
            border-color: transparent !important;
        }

        /* Animaci칩n opcional de escala al presionar */
        .btn-copy i {
            transition: transform 0.1s ease;
        }

        .btn-copy:active i {
            transform: scale(1.3);
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -280px;
                z-index: 1050;
                height: 100%;
            }

            .sidebar.show {
                transform: translateX(280px);
            }
        }
    </style>
</head>

<body class="d-flex bg-body">

    <aside class="sidebar d-flex flex-column bg-body-tertiary border-end position-relative vh-100" id="sidebar"
        style="min-width: 260px; max-width: 100vw;">
        <div class="d-flex flex-column h-100">

            <div class="border-bottom mb-auto p-2">
                <div class="list-group list-group-flush">
                    <a href="#"
                        class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent d-flex align-items-center py-3">
                        <i class="bi bi-list me-2"></i>
                    </a>
                    <a href="#"
                        class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent d-flex align-items-center">
                        <i class="bi bi-plus-lg me-2"></i> Nuevo chat
                    </a>

                </div>

            </div>




            <div class="flex-grow-1 overflow-auto p-2">
                <div class="list-group list-group-flush">
                    <a href="#"
                        class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent active bg-secondary-subtle text-body fw-medium"
                        aria-current="true">
                        Quiero la ficha cliente
                    </a>
                    <a href="#" class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent">
                        Necesito el carnet del cliente
                    </a>
                    <a href="#" class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent">
                        Informaci칩n sobre vacaciones
                    </a>
                </div>
            </div>

            <div class="border-top mt-auto p-2">
                <div class="list-group list-group-flush">

                    <button class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent"
                        id="themeToggle" title="Cambiar tema">
                        <i class="bi bi-sun-fill me-2" id="themeIcon"></i>
                    </button>

                    <!-- <a href="#" class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent"
                        id="themeToggle" title="Cambiar tema">
                        <i class="bi bi-sun-fill me-2" id="themeIcon"></i>
                    </a> -->

                    <a href="#" class="list-group-item list-group-item-action border-0 rounded-3 mb-1 bg-transparent">
                        <i class="bi bi-box-arrow-right me-2"></i> Cerrar Sesion
                    </a>
                </div>
            </div>
        </div>
    </aside>

    <main class="d-flex flex-column flex-grow-1">
        <header class="p-3 border-bottom d-flex align-items-center justify-content-between bg-body">
            <div class="d-flex align-items-center">
                <button class="btn d-md-none me-2"
                    onclick="document.getElementById('sidebar').classList.toggle('show')">
                    <i class="bi bi-list"></i>
                </button>
                <h6 class="mb-0">Ficha Cliente</h6>
            </div>
            <button class="btn btn-sm btn-outline-secondary rounded-pill">General <i
                    class="bi bi-chevron-down ms-1"></i></button>
        </header>

        <!-- <div class="flex-grow-1 overflow-y-auto p-4">
            <div class="chat-container">
                <div class="text-center py-5">
                    <h2 class="display-6 mb-5 fw-medium">쮼n qu칠 puedo ayudarte hoy?</h2>
                    <div class="row g-3">
                        <div class="col-sm-6">
                            <div class="p-4 border rounded-4 bg-body-tertiary shadow-sm h-100">游눹 Buscar informaci칩n
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="p-4 border rounded-4 bg-body-tertiary shadow-sm h-100">九꽲잺 Responder preguntas
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
        <div class="flex-grow-1 overflow-y-auto no-scroll p-4">
            <div class="chat-container">
                <div class="py-2 my-3 d-flex justify-content-end ">
                    <p class="m-0 d-inline-block bg-body-tertiary rounded p-2">
                        Prueba
                    </p>
                </div>




                <div class="py-2 my-3 d-flex justify-content-start">
                    <div class="d-flex flex-column align-items-start" style="max-width: 90%;">

                        <div class="p-2 text-body">
                            <p class="m-0 lh-lg">
                                Esta es una respuesta directa sin bordes ni fondos,
                                manteniendo un espaciado limpio y legible.
                            </p>
                        </div>

                        <div class="d-flex gap-1 mt-1 ms-1">
                            <button class="btn btn-sm text-secondary btn-action-gemini border-0 bg-transparent"
                                onclick="handleLike(this)" title="Buen칤sima respuesta">
                                <i class="bi bi-hand-thumbs-up"></i>
                            </button>
                            <button class="btn btn-sm text-secondary btn-action-gemini border-0 bg-transparent"
                                onclick="handleDislike(this)" title="Mala respuesta">
                                <i class="bi bi-hand-thumbs-down"></i>
                            </button>
                            <button class="btn btn-sm text-secondary btn-action-gemini btn-copy border-0 bg-transparent"
                                title="Copiar">
                                <i class="bi bi-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>






                <div class="py-2 my-3 d-flex justify-content-end">
                    <p class="m-0 d-inline-block bg-body-tertiary rounded p-2">
                        Prueba
                    </p>
                </div>

                <div class="py-2 my-3 d-flex justify-content-start">
                    <p class="m-0 d-inline-block p-2">
                        Prueba respuesta
                    </p>
                </div>
                <div class="py-2 my-3 d-flex justify-content-end">
                    <p class="m-0 d-inline-block bg-body-tertiary rounded p-2">
                        Prueba
                    </p>
                </div>
                <div class="py-2 my-3 d-flex justify-content-start">
                    <p class="m-0 d-inline-block p-2">
                        Prueba Lorem ipsum dolor sit amet, consectetur adipisicing elit. Maiores quibusdam delectus non
                        optio, mollitia odio perferendis temporibus doloremque aliquam, architecto obcaecati pariatur
                        beatae repellat cumque et hic dolor voluptas! Nesciunt! Lorem ipsum dolor sit, amet consectetur
                        adipisicing elit. Earum deleniti, vero facilis porro recusandae ex placeat dolorum officiis
                        atque similique ab enim iste praesentium quasi aspernatur amet odit necessitatibus asperiores? l
                    </p>
                </div>



            </div>
        </div>



        <footer class="p-4 bg-body mt-auto">
            <div class="chat-container">
                <div class="bg-body-tertiary border rounded-4 p-2 shadow-sm d-flex align-items-end">
                    <textarea id="chatInput" class="form-control bg-transparent" placeholder="Env칤a un mensaje..."
                        rows="1"></textarea>
                    <button class="btn btn-dark rounded-3 m-1 px-3 shadow-sm" id="sendBtn">
                        <i class="bi bi-arrow-up"></i>
                    </button>
                </div>
                <p class="text-center text-muted mt-2 mb-0" style="font-size: 11px;">Generado por IA. Verificar
                    precisi칩n</p>
            </div>
        </footer>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const themeToggle = document.getElementById('themeToggle');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatMessages = document.getElementById('chatMessages');
        const html = document.documentElement;


        function toggleTheme() {
            const currentTheme = html.getAttribute('data-bs-theme');
            const targetTheme = currentTheme === 'light' ? 'dark' : 'light';

            html.setAttribute('data-bs-theme', targetTheme);

            // Actualizar iconos y estilos de botones
            if (targetTheme === 'dark') {
                themeIcon.className = 'bi bi-moon-stars-fill';
                newChatBtn.classList.replace('btn-dark', 'btn-light');
                sendBtn.classList.replace('btn-dark', 'btn-light');
            } else {
                themeIcon.className = 'bi bi-sun-fill';
                newChatBtn.classList.replace('btn-light', 'btn-dark');
                sendBtn.classList.replace('btn-light', 'btn-dark');
            }
        }

        themeToggle.addEventListener('click', toggleTheme);


        //ENVIAR MENSAJE
        // document.getElementById('sendBtn').addEventListener('click', function () {
        //     const input = document.getElementById('chatInput');
        //     const messageText = input.value.trim();
        //     const chatContainer = document.querySelector('.chat-container');

        //     if (messageText !== "") {
        //         // Crear el bloque de mensaje con el dise침o que pediste
        //         const newMessage = `
        //         <div class="py-2 my-3 d-flex justify-content-end ">
        //             <p class="m-0 d-inline-block bg-body-tertiary rounded p-2">
        //                ${messageText}
        //             </p>
        //         </div>`;

        //         // Insertar el mensaje en el contenedor
        //         chatContainer.insertAdjacentHTML('beforeend', newMessage);

        //         // Limpiar el textarea y resetear su altura
        //         input.value = "";
        //         input.style.height = 'auto';

        //         // Scroll autom치tico al final
        //         const scrollArea = document.querySelector('.overflow-y-auto');
        //         scrollArea.scrollTop = scrollArea.scrollHeight;
        //     }
        // });

        // Tambi칠n permitir enviar con la tecla Enter (sin Shift)
        document.getElementById('chatInput').addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                document.getElementById('sendBtn').click();
            }
        });






        //BOTONES RESPUESTA IA
        // Manejo de LIKE
        function handleLike(btn) {
            const container = btn.parentElement;
            const likeIcon = btn.querySelector('i');
            const dislikeBtn = container.querySelector('.bi-hand-thumbs-down, .bi-hand-thumbs-down-fill').closest('button');
            const dislikeIcon = dislikeBtn.querySelector('i');

            // Si el que clickeamos ya est치 activo: lo apagamos y salimos
            if (likeIcon.classList.contains('bi-hand-thumbs-up-fill')) {
                resetBtn(btn, likeIcon, 'up');
                return;
            }

            // Si no est치 activo: Apagamos AMBOS primero (Limpieza total)
            resetBtn(btn, likeIcon, 'up');
            resetBtn(dislikeBtn, dislikeIcon, 'down');

            // Activamos el de Like
            activateBtn(btn, likeIcon, 'up');
        }

        function handleDislike(btn) {
            const container = btn.parentElement;
            const dislikeIcon = btn.querySelector('i');
            const likeBtn = container.querySelector('.bi-hand-thumbs-up, .bi-hand-thumbs-up-fill').closest('button');
            const likeIcon = likeBtn.querySelector('i');

            // Si el que clickeamos ya est치 activo: lo apagamos y salimos
            if (dislikeIcon.classList.contains('bi-hand-thumbs-down-fill')) {
                resetBtn(btn, dislikeIcon, 'down');
                return;
            }

            // Si no est치 activo: Apagamos AMBOS primero
            resetBtn(btn, dislikeIcon, 'down');
            resetBtn(likeBtn, likeIcon, 'up');

            // Activamos el de Dislike
            activateBtn(btn, dislikeIcon, 'down');
        }

        // Funciones auxiliares para no repetir l칩gica
        function resetBtn(btn, icon, type) {
            icon.classList.remove(`bi-hand-thumbs-${type}-fill`);
            icon.classList.add(`bi-hand-thumbs-${type}`);
            btn.classList.remove('text-body');
            btn.classList.add('text-secondary');
        }

        function activateBtn(btn, icon, type) {
            icon.classList.remove(`bi-hand-thumbs-${type}`);
            icon.classList.add(`bi-hand-thumbs-${type}-fill`);
            btn.classList.remove('text-secondary');
            btn.classList.add('text-body');
        }

        // Manejo de COPIAR (con feedback visual de Gemini)
        document.addEventListener('click', function (e) {
            const btn = e.target.closest('.btn-copy');
            if (btn) {
                const text = btn.closest('.flex-column').querySelector('p').innerText;

                navigator.clipboard.writeText(text).then(() => {
                    const toastElement = document.getElementById('copyToast');
                    if (toastElement) {
                        const toast = new bootstrap.Toast(toastElement, { delay: 2000 });
                        toast.show();
                    }
                });
                // No a침adimos cambios de clase aqu칤, el CSS :active se encarga de todo
            }
        });

        //RECIVIR MENSAJE (RESPUETA IA POR PANTALLA)
        document.getElementById('sendBtn').addEventListener('click', async function () {
            const input = document.getElementById('chatInput');
            const messageText = input.value.trim();
            const chatContainer = document.querySelector('.chat-container');
            const scrollArea = document.querySelector('.overflow-y-auto');

            if (messageText !== "") {
                // 1. Insertar mensaje del USUARIO
                const userMessage = `
            <div class="py-2 my-3 d-flex justify-content-end animate-in">
                <p class="m-0 d-inline-block bg-body-tertiary rounded-4 p-3 shadow-sm border">
                    ${messageText}
                </p>
            </div>`;
                chatContainer.insertAdjacentHTML('beforeend', userMessage);

                // Limpiar input
                input.value = "";
                input.style.height = 'auto';
                scrollArea.scrollTo({ top: scrollArea.scrollHeight, behavior: 'smooth' });

                // 2. Insertar Placeholder de la IA (Cargando...)
                const aiId = 'ai-' + Date.now();
                const aiPlaceholder = `
            <div class="py-2 my-3 d-flex justify-content-start animate-in" id="${aiId}">
                <div class="d-flex flex-column align-items-start" style="max-width: 90%;">
                    <div class="p-2 text-body">
                        <div class="spinner-grow spinner-grow-sm text-secondary" role="status"></div>
                    </div>
                </div>
            </div>`;
                chatContainer.insertAdjacentHTML('beforeend', aiPlaceholder);
                scrollArea.scrollTo({ top: scrollArea.scrollHeight, behavior: 'smooth' });

                try {
                    // 3. Llamada al Servicio (Fetch)
                    // const response = await fetch('TU_URL_AQUI', {
                    //     method: 'POST',
                    //     headers: { 'Content-Type': 'application/json' },
                    //     body: JSON.stringify({ message: messageText })
                    // });
                    // const data = await response.json();
                    const aiText = 'Respuesta IA'; // Ajustar seg칰n tu API
                    // const aiText = data.respuesta; 
                    // 4. Reemplazar Placeholder con la Respuesta Real + Botones Gemini
                    const aiElement = document.getElementById(aiId);
                    aiElement.innerHTML = `
                <div class="d-flex flex-column align-items-start" style="max-width: 90%;">
                    <div class="p-2 text-body">
                        <p class="m-0 lh-lg">${aiText}</p>
                    </div>
                    <div class="d-flex gap-1 mt-1 ms-1">
                        <button class="btn btn-sm text-secondary btn-action-gemini border-0 bg-transparent" onclick="handleLike(this)" title="Buen칤sima respuesta">
                            <i class="bi bi-hand-thumbs-up"></i>
                        </button>
                        <button class="btn btn-sm text-secondary btn-action-gemini border-0 bg-transparent" onclick="handleDislike(this)" title="Mala respuesta">
                            <i class="bi bi-hand-thumbs-down"></i>
                        </button>
                        <button class="btn btn-sm text-secondary btn-action-gemini btn-copy border-0 bg-transparent" title="Copiar">
                            <i class="bi bi-copy"></i>
                        </button>
                    </div>
                </div>`;

                } catch (error) {
                    console.error(error);
                    document.getElementById(aiId).innerHTML = `<p class="text-danger small p-2">Error al conectar.</p>`;
                }

                scrollArea.scrollTo({ top: scrollArea.scrollHeight, behavior: 'smooth' });
            }
        });

    </script>

    <div class="toast-container position-fixed bottom-0 start-50 translate-middle-x p-3">
        <div id="copyToast" class="toast align-items-center text-white bg-dark border-0 rounded-pill shadow-sm"
            role="alert">
            <div class="d-flex">
                <div class="toast-body small px-3">
                    <i class="bi bi-check2"></i> Copiado al portapapeles
                </div>
            </div>
        </div>
    </div>

</body>

</html>
